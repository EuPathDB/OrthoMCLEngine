#!/usr/bin/perl

use DBI;
use strict;

usage() unless scalar(@ARGV) == 1;

my $changedGroupsFile = $ARGV[0];

my $dbh = DBI->connect("dbi:Oracle:orth500n", "sfischer", "",
		    {PrintError => 0, RaiseError => 1}) or die DBI::errstr;

my $sql = "
insert into apidb.GroupsChangedInPlanA (group_id, min_score, max_score, sum_score, avg_score)
values (?, ?, ?, ?, ?)
";

open(F, $changedGroupsFile) || die "can't open file $changedGroupsFile\n";

my $stmt = $dbh->prepare($sql);
while(<F>) {
    chomp;
    s/\://;
    my @a = split;
    
    $stmt->execute(@a);
}

sub usage {
die "
 usage: orthomclAssessGroups groups_file output_groups_score_file output_proteins_score_file
";
}

