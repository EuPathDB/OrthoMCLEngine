THIS FILE IS UNDER CONSTRUCTION.  please mail stevef@pcbi.upenn.edu with questions....


----INSTALLATION OVERVIEW---------------------------

I.	General Requirements
II.	Installing from OS Specific Packages
III.	Installing from General Linux/Unix Binary Packages
IV.	Creating a Database and User Account
V.	Optimizing MySQL
VI.     Troubleshooting Installation Issues
VII.    Removing Your MySQL Installation
----------------------------------------------------
----------------------------------------------------
I. General Requirements  

    -  MySQL server 5.1 or greater
    -  MySQL DBI driver module for PERL (available at CPAN)
    -  Unix/Linux or MacOS 10.0.1 or greater

----------------------------------------------------
----------------------------------------------------
II. Installing MySQL from OS Specific Packages (Root access required)

MySQL has pre-packaged installation suites for many operating systems (RPM, Solaris or MacOS pkg, etc). To determine if packages have been created for your operating system
  - Go to http://www.mysql.com/downloads
  - Click on "Download" under MySQL Community Server

If packages exist specific to your operating system, these packages provide the quickest method of installing the MySQL server, but please note that the installation directory for MySQL will vary from OS to OS, and you may find necessary to specify another directory when installing the package as default directory installations often require administrator privileges. Refer to the documentation for your operating system for instructions regarding OS specific package installation.

----------------------------------------------------
----------------------------------------------------
III. Installing MySQL From Linux/Unix Binary Packages (Root access not required)

- If you do not wish to use OS packages, or you need to install MySQL from a normal user account,      
  you can install MySQL using the following steps:


   1. Go to  http://www.mysql.com/downloads/
       - click on "Download" under MySQL Community Server
       - for linux: click on "Linux (non RPM packages)"
       - otherwise, find the .tar package for your OS
       - choose the download for your platform
          - use the 'uname -a' command if you don't know your platform 
       - either login/register or click "No thanks, just take me to the downloads!"
       - choose a mirror near you, and download

   2. Create a directory for your installation, and move the file to it.
       - This directory needs to be on a volume that has *adequate space* for all the data. 
         Please see the UserGuide.txt to estimate how much disk space you will need.
       - (See step 6 below if you want to relocate the mysql data to a separate volume.)


   3. Unzip the downloaded file into the directory:
  
		tar -xzvf mysql-standard-5.1.34-linux-i686-glibc23.tar.gz
                rm mysql-standard-5.1.34-linux-i686-glibc23.tar.gz   (to save disk space)

   4. Give the new directory a shortcut name

	 	ln -s mysql-standard-5.1.34-linux-i686-glibc23 mysql

   5. Change to the mysql directory and set up the default MySQL databases.

	        cd mysql
                ./scripts/mysql_install_db --basedir=../mysql --datadir=../mysql/data
    
        NOTE: The script will inform that you that need to set a root password. 
              Don't worry about this for now; you will perform this task in another step.

   6. Configure mysql using sample config file provided in orthomcl download

               cp my_orthomcl_dir/doc/mysql.cnf .

       - set the basedir= and datadir= properties to reflect where your mysql/ dir and data/ dir are
       - if port 3306 is already in use, set the port= property to a different port
           - to see if 3306 is in use, type this command:
                    netstat -a | grep tcp | grep 3306 
           - if so, set port=3307 (or 3308, etc., if 3307 is already used) 
       - set myisam_sort_buffer_size= to 50% of available ram
           - to find out how much ram you have:
                dmesg | grep Memory
           - it gives you a report in kilobytes.  divide by 1000000 to get a number of Gs.
       - set myisam_max_sort_file_size= to 5 x the size of the file made by orthomclBlastParser.  make sure
         you have space on the volume used by the datadir= to easily hold that.
       - set read_buffer_size= to ???

   7. You are now ready to start your MySQL server as a background process. To do so, from within the mysql 
      directory base install, run:

           ./bin/mysqld_safe --defaults-file=mysql.cnf &
        
         NOTE: You *must* run this command from the mysql directory.
               You should see something similar to the following:

 		[1] 67786% Starting mysqld daemon with databases from home/youraccountname/mysql/data

   8. At this point your MySQL password is still blank. Use the following command to set a new                     
      root password:

		./bin/mysqladmin --defaults-file=mysql.cnf -u root password "yourpasswordhere"

--------------------------------------------------
--------------------------------------------------
IV. Create a New Database and User Account

   1. Log in to your mysql server as root. If you are logging in to an existing MySQL server, 
      use any existing account that can create a user and grant privileges: 

		./bin/mysql --defaults-file=mysql.cnf -u root -p

      Enter the root password you set in Step 7 when prompted.

   2. Once logged in as root, create the database and user (schema) that you will use for OrthoMCL
      (we use orthomcl as an example here), and grant the user account the necessary privileges:
 
              mysql> CREATE DATABASE orthomcl;
	
	      mysql> GRANT SELECT,INSERT,UPDATE,DELETE,CREATE VIEW,CREATE, INDEX, DROP on orthomcl.* TO orthomcl@localhost;
	
 	      mysql> set password for orthomcl@localhost = password('yourpassword');

-------------------------------------------------
-------------------------------------------------
V. MySQL Server Optimization

   - If you are using an existing MySQL database, you may need to adjust its configuration
     to handle the volume of data in your blast results.  (If you just installed MySQL
     following the instructions above, this is already handled).
   
         -To view the key values, log in to mysql and run these commands:
          
                 mysql> show variables LIKE 'myisam_max_sort_file_size';
               
                 mysql> show variables LIKE 'myisam_sort_buffer_size';

                 mysql> show variables LIKE 'read_buffer_size';     

         
          NOTE: These values will display in bytes, i.e. a value of
                2147479552 for read_buffer_size is equivalent to 2 Gigabytes.

    
   - See step III.6 for suggested settings for these properties

-------------------------------------------------
-------------------------------------------------
VI. Troublshooting Installation Issues

   The MySQL server logs all status and error messages in a file called
yourhost.err, where yourhost is the name of your machine. The file is located 
in the mysql/data directory and contains useful information for debugging problems 
with your MySQL server.

Below are some common installation issues and resolutions:

 (1)
     ISSUE: Your MySQL installation is conflicting with another install

        - You may be conflicting with an existing MySQL install if you see an
          error in your log similar to the following when running mysql_install_db, 
          mysqladmin, or mysql:

              Installing MySQL system tables...
              090515 13:32:49 [Warning] Can't create test file
              /var/lib/mysql/localhost.lower-test
              090515 13:32:49 [Warning] Can't create test file
              /var/lib/mysql/localhost.lower-test
              ERROR: 1005  Can't create table 'db' (errno: 13)
              090515 13:32:49 [ERROR] Aborting

          
     RESOLUTION:

         - A path is set incorrect in your mysql.cnf if you see a reference to
           /var/lib in your error log. Check to ensure that you have correctly 
           set the mysql_sock and port parameters in mysql.cnf.

 (2)
     ISSUE: Unspecified or Misconfigured mysql.cnf file 

        - If only the first numeric line appears (you do not see a "Starting
          mysqld daemon..." message) when you execute ./bin/mysqld_safe &, you
          probably entered at least one incorrect path in your mysql.cnf file, or
          you did not specify --defaults-file=mysql.cnf when starting MySQL.


     RESOLUTION:

        - Check to ensure that:  

           - You specified the --defaults-file=mysql.cnf when running mysql or
             a mysqladmin command.
        
           - Your mysql.cnf parameters correctly reflect your MySQL
             installation path. 
   
                

-------------------------------------------------
-------------------------------------------------
VII. Removing Your MySQL Installation

  - If you wish to remove your MySQL installation, this can be performed in
    two simple steps:

       (1) Shutdown your MySQL server:

            cd mysql
            ./bin/mysqladmin --defaults-file=mysql.cnf -u root -p shutdown

     
       (2) Change to the parent directory of your MySQL installation, and remove 
           the mysql directory and symbolic link:

       
            rm -r -f mysql-standard-5.1.34-linux-i686-glibc23 
            rm mysql


            NOTE: Always use caution when using the rm -r -f command! This
                  command deletes an entire directory structory with no request
                  for confirmation, so be sure the correct directory is specified.







          
	    

		
 




